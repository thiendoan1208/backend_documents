Chapter 0: Introduction to Backend Developer

	1. Backend dev l√† g√¨

+ Backend (hay c√≤n g·ªçi l√† ph√≠a m√°y ch·ªß) l√† ph·∫ßn ph√≠a sau c·ªßa m·ªôt ·ª©ng d·ª•ng ho·∫∑c website ‚Äì n∆°i x·ª≠ l√Ω d·ªØ li·ªáu, logic, v√† t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, m√°y ch·ªß, ho·∫∑c API. ƒê√¢y l√† ph·∫ßn ng∆∞·ªùi d√πng kh√¥ng nh√¨n th·∫•y ƒë∆∞·ª£c, nh∆∞ng ƒë√≥ng vai tr√≤ c·ª±c k·ª≥ quan tr·ªçng.


üîß C√°c ch·ª©c nƒÉng ch√≠nh c·ªßa Backend:

X·ª≠ l√Ω logic ·ª©ng d·ª•ng: Nh∆∞ t√≠nh to√°n, ki·ªÉm tra ƒëi·ªÅu ki·ªán, ph√¢n quy·ªÅn ng∆∞·ªùi d√πng...

K·∫øt n·ªëi v·ªõi c∆° s·ªü d·ªØ li·ªáu: L∆∞u tr·ªØ, truy xu·∫•t, c·∫≠p nh·∫≠t, ho·∫∑c xo√° d·ªØ li·ªáu.

X√°c th·ª±c ng∆∞·ªùi d√πng: ƒêƒÉng nh·∫≠p, ƒëƒÉng k√Ω, ph√¢n quy·ªÅn...

X·ª≠ l√Ω API: G·ª≠i v√† nh·∫≠n d·ªØ li·ªáu gi·ªØa client (frontend) v√† server.

B·∫£o m·∫≠t: M√£ ho√° d·ªØ li·ªáu, b·∫£o v·ªá kh·ªèi t·∫•n c√¥ng (nh∆∞ SQL Injection, XSS‚Ä¶).


üõ† C√°c c√¥ng ngh·ªá ph·ªï bi·∫øn trong Backend:

C√¥ng ngh·ªá	Vai tr√≤
Ng√¥n ng·ªØ	JavaScript (Node.js), Python (Django, Flask), PHP, Ruby, Java, C#...

C∆° s·ªü d·ªØ li·ªáu	MySQL, PostgreSQL, MongoDB, SQLite...

M√°y ch·ªß (server)	Apache, Nginx, Express (Node.js)...

API	RESTful API, GraphQL...


üîÑ So s√°nh Frontend v√† Backend:

Ti√™u ch√≠	Frontend	Backend

Hi·ªÉn th·ªã	Ng∆∞·ªùi d√πng nh√¨n th·∫•y	Ng∆∞·ªùi d√πng kh√¥ng nh√¨n th·∫•y

Vai tr√≤		Giao di·ªán, t∆∞∆°ng t√°c ng∆∞·ªùi d√πng	X·ª≠ l√Ω d·ªØ li·ªáu, logic, k·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu

C√¥ng ngh·ªá	HTML, CSS, JavaScript (React, Vue‚Ä¶)	Node.js, Python, Java, C#, PHP...


	2. SSR v√† CSR, 2 c√°ch l√†m vi·ªác v·ªõi BE


üñ•Ô∏è SSR (Server-Side Rendering) ‚Äî v√≠ d·ª• d√πng EJS, Pug:

Back-end (BE) s·∫Ω x·ª≠ l√Ω:

L·∫•y d·ªØ li·ªáu t·ª´ database.

Render d·ªØ li·ªáu tr·ª±c ti·∫øp v√†o HTML (th∆∞·ªùng th√¥ng qua template engine nh∆∞ EJS, Pug).

FE (Front-end) ch·ªâ l√† k·∫øt qu·∫£ HTML ƒë√£ ƒë∆∞·ª£c render s·∫µn, tr√¨nh duy·ªát nh·∫≠n v√† hi·ªÉn th·ªã lu√¥n.

>>>>>

	+ ∆Øu ƒëi·ªÉm:

T·ªët cho SEO.

Hi·ªÉn th·ªã nhanh n·ªôi dung cho ng∆∞·ªùi d√πng.

	+ Nh∆∞·ª£c ƒëi·ªÉm:

M·ªói l·∫ßn chuy·ªÉn trang l√† reload l·∫°i trang m·ªõi.

Kh√≥ t∆∞∆°ng t√°c ƒë·ªông so v·ªõi SPA.

üß† CSR (Client-Side Rendering) ‚Äî th∆∞·ªùng d√πng v·ªõi React, Vue, v.v.

Back-end ch·ªâ cung c·∫•p RESTful API (ho·∫∑c GraphQL).

Front-end (React/Vue) s·∫Ω:

G·ªçi API ƒë·ªÉ l·∫•y d·ªØ li·ªáu.

T·ª± ƒë·ªông render d·ªØ li·ªáu l√™n giao di·ªán trong tr√¨nh duy·ªát.

	+ ∆Øu ƒëi·ªÉm:

Tr·∫£i nghi·ªám ng∆∞·ªùi d√πng m∆∞·ª£t m√†, kh√¥ng reload.

D·ªÖ ph√°t tri·ªÉn c√°c app ph·ª©c t·∫°p.

	+ Nh∆∞·ª£c ƒëi·ªÉm:

SEO kh√¥ng t·ªët n·∫øu kh√¥ng d√πng th√™m c√¥ng ngh·ªá h·ªó tr·ª£ nh∆∞ Next.js.

L·∫ßn ƒë·∫ßu t·∫£i c√≥ th·ªÉ ch·∫≠m v√¨ ph·∫£i load JS r·ªìi m·ªõi g·ªçi API.



Chapter 1: Website ho·∫°t ƒë·ªông nh∆∞ n√†o ?

#1. X√¢y d·ª±ng ch·ª©c nƒÉng c·ªßa 1 website

> M·ªôt website d√π ph·ª©c t·∫°p ƒë·∫øn ƒë√¢u, ƒë·ªÅu xoay quanh c√°c t√≠nh nƒÉng v·ªÅ CRUD.

	+ CRUD l√† vi·∫øt t·∫Øt c·ªßa Create, Read, Update v√† Delete.

	1. Create (C) : th√™m m·ªõi
	+ Create: t·∫°o ra 1 c√°i g√¨ ƒë·∫•y m·ªõi, t·∫°o ra th√™m d·ªØ li·ªáu

	V√≠ d·ª•: b·∫°n ƒëƒÉng 1 b√†i post facebook ƒë·ªÉ c·∫≠p nh·∫≠t tr·∫°ng th√°i
	=> g√≥c nh√¨n dev: user CREATE a new post


	2. Read (R) : hi·ªÉn th·ªã (ƒë·ªçc th√¥ng tin hi·ªÉn th·ªã)
	+ Read: l√† ch·ª©c nƒÉng gi√∫p hi·ªÉn th·ªã th√¥ng tin

	v√≠ d·ª•: b·∫°n l∆∞·ªõt newFeed facebook ƒë·ªÉ c·∫≠p nh·∫≠t th√¥ng tin c·ªßa b·∫°n b√®, 'ƒë·ªçc' c√°c th√¥ng 	tin m·ªõi.
	=> g√≥c nh√¨n dev: hi·ªÉn th·ªã (READ) c√°c b√†i post

	3. Update (U): c·∫≠p nh·∫≠t th√¥ng tin

	v√≠ d·ª•: b·∫°n ƒëƒÉng 1 b√†i post, ph√°t hi·ªán l·ªói ch√≠nh t·∫£ => nh·∫•n n√∫t edit ƒë·ªÉ s·ª≠a, sau ƒë·∫•y 	nh·∫•n n√∫t 'save' ƒë·ªÉ x√°c nh·∫≠n c·∫≠p nh·∫≠t
	=> g√≥c nh√¨n dev: th·ª±c hi·ªán update th√¥ng tin v·ªõi b√†i post c·∫ßn c·∫≠p nh·∫≠t

	
	4. Delete (D): x√≥a th√¥ng tin

	v√≠ d·ª•: b√†i post b·∫°n ƒëƒÉng l√™n t·∫°o s√≥ng gi√≥ tr√™n m·∫°ng x√£ h·ªôi, g√¢y cho b·∫°n nhi·ªÅu phi·ªÅn
	ph·ª©c. v√¨ v·∫≠y b·∫°n l·ª±a ch·ªçn option delete ƒë·ªÉ khi·∫øn cho b√†i post bi·∫øn m·∫•t

	=> g√≥c nh√¨n dev: th·ª±c hi·ªán delete b√†i post ƒë∆∞·ª£c y√™u c·∫ßu


	5. X√¢y d·ª±ng t√≠nh nƒÉng

	+ M·ªôt t√≠nh nƒÉng d√π ph·ª©c t·∫°p ƒë·∫øn ƒë√¢u, ƒë·ªÅu ph√¢n theo CRUD. N·∫øu kh√°c, ƒë·∫•y ch√≠nh l√† 	logic x·ª≠ l√Ω

=> c·∫ßn t√≠nh to√°n x·ª≠ l√Ω tr∆∞·ªõc khi th·ª±c hi·ªán 1 h√†nh ƒë·ªông.

B·∫•t k·ª≥ d·ª± √°n n√†o, t√≠nh nƒÉng ƒë·ªÅu g√≥i g·ªçn v·ªõi CRUD
=> h·ªçc 1 framework/language => th·ª±c h√†nh CRUD



#2. M√¥ h√¨nh ho·∫°t ƒë·ªông 

M√¥ h√¨nh client-server:

https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_web_server


1. ƒê·ªãnh nghƒ©a

- Client (ng∆∞·ªùi d√πng/user): ng∆∞·ªùi s·ª≠ d·ª•ng website b·∫±ng c√¥ng c·ª•,
v√≠ d·ª•: tr√¨nh duy·ªát web (browser: Google Chrome, Firefox...)


- Server (m√°y ch·ªß): g·ªìm 2 th√†nh ph·∫ßn
+ t√™n mi·ªÅn (domain) : l√† 1 t√™n d·ªÖ nh·ªõ, gi√∫p client c√≥ th·ªÉ nh·ªõ, g√µ v√†o tr√¨nh duy·ªát v√† s·ª≠
d·ª•ng
+ n∆°i hosting files: l√† 1 m√°y t√≠nh tr√™n cloud (k·∫øt n·ªëi internet), l∆∞u tr·ªØ t·∫•t c·∫£ m√£ ngu·ªìn
c·ªßa website

+ Hi·ªÉu ƒë∆°n gi·∫£n, server l√† 1 m√°y t√≠nh ho·∫°t ƒë·ªông 24/24, gi√∫p 1 website ho·∫°t ƒë·ªông.


2. M√¥ h√¨nh 

·ªû ƒë√¢y, m√¥ h√¨nh s·∫Ω l√† y√™u c·∫ßu <-> ph·∫£n h·ªìi (request <-> response)

	> client -> g·ª≠i request l√™n server

(B·∫°n A g√µ facebook.com, enter v√† ng·ªìi ch·ªù website load giao di·ªán Facebook.com -
mong mu·ªën s·ª≠ d·ª•ng website)

	> server -> g·ª≠i response cho client (Server nh·∫≠n ƒëc y√™u c·∫ßu c·ªßa client, s·∫Ω t·∫°o giao di·ªán website v√† g·ª≠i l·∫°i k·∫øt qu·∫£ - giao di·ªán website facebook)



#3. V·∫≠n h√†nh 1 website

	1. Ch·∫°y localhost

(local t·ª©c l√† ch·∫°y t·∫°i m√°y t√≠nh c√° nh√¢n, b·∫°n b√® (c·ªßa b·∫°n) kh√¥ng th·ªÉ d√πng ƒë∆∞·ªùng link
localhost ƒë·ªÉ ch·∫°y v√† s·ª≠ d·ª•ng website ƒë∆∞·ª£c)


+ client: ch√≠nh l√† b·∫°n lu√¥n (m·ªü website, g√µ ƒë∆∞·ªùng link v√† s·ª≠ d·ª•ng)
+ server: c√≤n ai ·ªü ƒë√¢y n·ªØa (ngo√†i b·∫°n th√¨ c√≤n ai kh√°c :v).
vi·ªác b·∫°n code, sau ƒë·∫•y g√µ l·ªánh s·∫Ω gi√∫p ch·∫°y server t·∫°i m√°y t√≠nh b·∫°n.

>>>>
+ ∆∞u ƒëi·ªÉm: b·∫°n ki·ªÉm so√°t m√£ ngu·ªìn, th√≠ch l√†m g√¨ th√¨ l√†m => ƒë√¢y l√† qu√° tr√¨nh x√¢y d·ª±ng
website t·ª´ con s·ªë 0 (l√†m t·ª´ ƒë·∫ßu)

+ nh∆∞·ª£c ƒëi·ªÉm: ch·∫°y local (m√°y t√≠nh c·ªßa b·∫°n), ng∆∞·ªùi kh√°c kh√¥ng th·ªÉ s·ª≠ d·ª•ng ƒë∆∞·ª£c
localhost


	2. Ch·∫°y v·ªõi hosting

g·ªìm 2 b∆∞·ªõc: mua t√™n mi·ªÅn v√† mua hosting

B1: T√™n mi·ªÅn (domain) l√† 1 t√™n d·ªÖ nh·ªõ, b·∫±ng ch·ªØ, v√≠ d·ª•: facebook.com, twitter.com

B2: Mua hosting v√† deploy code c·ªßa b·∫°n l√™n ƒë·∫•y. Vi·ªác mua hosting s·∫Ω cho b·∫°n 1 ƒë·ªãa ch·ªâ IP (IP c·ªßa server, v√≠ d·ª•: 192.168.1.69), ƒë·ªìng th·ªùi cung c·∫•p ngu·ªìn t√†i nguy√™n ƒë·ªÉ b·∫°n tri·ªÉn khai (deploy) code local l√™n l∆∞u tr·ªØ t·∫°i ƒë√¢y.

B3: Sau khi deploy xong, b·∫°n c·∫ßn mapping domain v·ªõi c√°i IP hosting n√†y.


	>>>>> Hi·ªÉu ƒë∆°n gi·∫£n l√† nh∆∞ n√†y: <<<<<


B1: b·∫°n b·ªè ti·ªÅn ra mua 1 t√™n mi·ªÅn (domain).

T√™n mi·ªÅn l√† duy nh·∫•t (unique), th√†nh ra, b·∫°n ph·∫£i nghƒ© ra v√† mua 1 c√°i t√™n ch∆∞a ƒë∆∞·ª£c s·ª≠ d·ª•ng tr∆∞·ªõc ƒë·∫•y. c√¥ng d·ª•ng c·ªßa n√≥ l√† mua 1 c√°i t√™n d·ªÖ vi·∫øt, d·ªÖ nh·ªõ v√† kh√¥ng ƒë·ª•ng h√†ng (unique)

v√≠ d·ª•: b·∫°n nh·ªõ trang google.com ch·ª© kh√¥ng nh·ªõ 192.168.1.69
th√¨ ·ªü ƒë√¢y: google.com ch√≠nh l√† t√™n mi·ªÅn


B2: mua 1 m√°y t√≠nh server(hosting) (ch·∫°y tr√™n cloud).

M√°y t√≠nh tr√™n cloud s·∫Ω c√≥ 1 ƒë·ªãa ch·ªâ IP, v√≠ d·ª• 192.168.1.96. Ch√∫ng ta c·∫ßn ƒë·ªãa ch·ªâ n√†y ƒë·ªÉ c√≥ th·ªÉ truy c·∫≠p v√†o n√≥.Sau khi truy c·∫≠p v√†o server n√†y, c√°c b·∫°n c·∫ßn t·∫£i code (local) l√™n tr√™n n√†y l∆∞u tr·ªØ,v√† c√†i ƒë·∫∑t c√°c ph·∫ßn m·ªÅm c·∫ßn thi·∫øt,v√≠ d·ª• nh∆∞ database ch·∫≥ng h·∫°n.

=> ƒë√¢y g·ªçi l√† b∆∞·ªõc deploy, gi√∫p chuy·ªÉn code t·ª´ m√°y t√≠nh local l√™n 1 m√°y t√≠nh ·ªü cloud.


B3: C·∫•u h√¨nh t√™n mi·ªÅn tr·ªè v√†o ƒë·ªãa ch·ªâ IP server. T·ª©c l√†: khi ng∆∞·ªùi d√πng g√µ ten-mien-cua-ban.com 

=> m√°y t√≠nh s·∫Ω t·ª± ƒë·ªông tr·ªè t·ªõi 192.168.1.96 (ƒë·ªãa ch·ªâ server)

Do m√°y t√≠nh server ho·∫°t ƒë·ªông 24/7 => b·∫°n c√≥ th·ªÉ truy c·∫≠p v√† s·ª≠ d·ª•ng website ·ªü b·∫•t c·ª© ƒë√¢u, b·∫•t c·ª© khi n√†o b·∫°n mu·ªën


- ∆∞u ƒëi·ªÉm: website ch·∫°y th·ª±c t·∫ø, 's·ªëng' 24/7, ai c≈©ng c√≥ th·ªÉ truy c·∫≠p v√† s·ª≠ d·ª•ng
- nh∆∞·ª£c ƒëi·ªÉm: t·ªën ti·ªÅn :v	


#4. D·ªØ Li·ªáu ƒê·ªÉ Hi·ªÉn Th·ªã Website

	1. D·ªØ li·ªáu tƒ©nh (static)

D·ªØ li·ªáu static l√† c√°c d·ªØ li·ªáu c·ªë ƒë·ªãnh, v√† kh√¥ng thay ƒë·ªïi theo th·ªùi gian. V√≠ d·ª•: t√™n/·∫£nh
th∆∞∆°ng hi·ªáu website

Do t√≠nh ch·∫•t 'c·ªë ƒë·ªãnh', ch√∫ng ta th∆∞·ªùng 'hard-code' fix c·ª©ng trong m√£ ngu·ªìn (source
code), vi·∫øt 1 l·∫ßn v√† d√πng m√£i m√£i.

∆Øu ƒëi·ªÉm: d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u trong source code, all-in-one
Nh∆∞·ª£c ƒëi·ªÉm: kh√≥ thay ƒë·ªïi khi c√≥ y√™u c·∫ßu s·ª≠a ƒë·ªïi


	2. D·ªØ li·ªáu ƒë·ªông (dynamic)

D·ªØ li·ªáu dynamic l√† d·ªØ li·ªáu thay ƒë·ªïi theo th·ªùi gian (ng∆∞·ª£c ho√†n to√†n v·ªõi static).

v√≠ d·ª•: h√¥m nay b·∫°n l∆∞·ªõt facebook, post hi·ªán l√™n n√≥ kh√°c, ng√†y mai n√≥ kh√°c v√† thay ƒë·ªïi li√™n t·ª•c.

∆Øu ƒëi·ªÉm: thay ƒë·ªïi li√™n t·ª•c theo th·ªùi gian
Nh∆∞·ª£c ƒëi·ªÉm: c·∫ßn code logic ƒë·ªÉ x·ª≠ l√Ω :D


	
	3.L∆∞u tr·ªØ d·ªØ li·ªáu

C√≥ 2 d·∫°ng l∆∞u tr·ªØ d·ªØ li·ªáu ph·ªï bi·∫øn: l∆∞u tr·ªØ data trong file v√† l∆∞u tr·ªØ d·ªØ li·ªáu trong 'ph·∫ßn m·ªÅm'

- L∆∞u tr·ªØ trong file: v√≠ d·ª•, b·∫°n l∆∞u tr·ªØ th√¥ng tin user trong file .txt, file .csv

∆∞u ƒëi·ªÉm: thu·∫≠n ti·ªán cho ng∆∞·ªùi kh√¥ng coding v√† quen thu·ªôc v·ªõi c√°c ph·∫ßn m·ªÅm c∆° b·∫£n (word, excel...)
nh∆∞·ª£c ƒëi·ªÉm: l∆∞u tr·ªØ data kh√¥ng hi·ªáu qu·∫£, n·∫øu nh∆∞ data g·ªìm nhi·ªÅu lo·∫°i d·ªØ li·ªáu, v√† kh·ªëi l∆∞·ª£ng k√≠ch th∆∞·ªõc l·ªõn


- L∆∞u tr·ªØ trong 'ph·∫ßn m·ªÅm': c√°c ph·∫ßn m·ªÅm h·ªó tr·ª£ vi·ªác l∆∞u tr·ªØ data, g·ªçi l√† c√°c h·ªá qu·∫£n tr·ªã c∆° s·ªü d·ªØ li·ªáu hi·ªÉu ƒë∆°n gi·∫£n l√† database.


∆∞u ƒëi·ªÉm: l∆∞u tr·ªØ data hi·ªáu qu·∫£, ƒë·∫£m b·∫£o l∆∞u tr·ªØ ƒë∆∞·ª£c nhi·ªÅu lo·∫°i d·ªØ li·ªáu v√† kh·ªëi l∆∞·ª£ng d·ªØ li·ªáu l·ªõn
nh∆∞·ª£c ƒëi·ªÉm: c·∫ßn 'h·ªçc' c√∫ ph√°p ƒë·ªÉ c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c ph·∫ßn m·ªÅm n√†y
	



#5. Website Khi C√≥ L∆∞u Tr·ªØ Data

Data ƒë∆∞·ª£c l∆∞u tr·ªØ ·ªü ƒë√¢u ?

1. V√≠ d·ª•: ng∆∞·ªùi d√πng th·ª±c hi·ªán h√†nh ƒë·ªông ƒëƒÉng nh·∫≠p
B1: nh·∫≠p username/password
B2: nh·∫•n n√∫t ƒëƒÉng nh·∫≠p
B3: nh·∫≠n k·∫øt qu·∫£

Th√¨ b√≠ m·∫≠t ƒë·ª©ng sau l√† g√¨:

T·∫°i b∆∞·ªõc 2 chuy·ªÉn qua b∆∞·ªõc 3, website s·∫Ω c·∫ßn ph·∫£i l√†m 1 c√°i g√¨ ƒë·∫•y, c·ª• th·ªÉ l√†:

- website s·∫Ω c·∫ßn ph·∫£i ki·ªÉm tra th√¥ng tin ng∆∞·ªùi d√πng cung c·∫•p, v√† th√¥ng tin 'n√≥ ƒë√£ l∆∞u tr·ªØ t·ª´ tr∆∞·ªõc ƒë·∫•y - t·∫≠p users'

- n·∫øu th√¥ng tin cung c·∫•p l√† ch√≠nh x√°c => th√†nh c√¥ng V·∫≠y website l∆∞u tr·ªØ data ·ªü ƒë√¢u ? => database

Ch√∫ng ta s·∫Ω d√πng database ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu.


#6. Database

  + Database l√† c√°ch ch√∫ng ta 't·ªï ch·ª©c v√† l∆∞u tr·ªØ' d·ªØ li·ªáu website m·ªôt c√°ch hi·ªáu qu·∫£.
V·ªõi database, ch√∫ng ta l∆∞u tr·ªØ d·ªØ li·ªáu v·ªõi 2 c√°ch:

- S·ª≠ d·ª•ng d·ªØ li·ªáu quan h·ªá (Relational Database - SQL) : MySQL, Postgres, Oracle, SQL
Server...

- S·ª≠ d·ª•ng d·ªØ li·ªáu phi quan h·ªá (Non-Relational Database / NoSQL): MongoDB, Redis...



Chapter 2: Web server v·ªõi Node.JS


 #1. What is Node.JS

	+ ƒê·ªÉ t·∫°o ra 1 web server ch√∫ng ta c·∫ßn s·ª≠ d·ª•ng c√°c ng√¥n ng·ªØ backend, c√≥ th·ªÉ k·ªÉ t·ªõi nh∆∞ Java, php, python, js,....

	+ Ch√∫ng ta kh√¥ng th·ªÉ s·ª≠ d·ª•ng c√°c c√¥ng c·ª• ·ªü FE ƒë·ªÉ vi·∫øt server, tuy nhi√™n JS l√† m·ªôt ngo·∫°i l·ªá 

	+ JS c√≥ th·ªÉ ch·∫°y ƒë∆∞·ª£c ·ªü FE v√† BE
	
 >> Node.JS l√† c√¥ng c·ª• (m√¥i tr∆∞·ªùng) gi√∫p ch√∫ng ta c√≥ th·ªÉ th·ª±c thi code JS ngay tr√™n server 

 >> Node.JS l√† 1 platform(m√¥i tr∆∞·ªùng) ch·ª© kh√¥ng ph·∫£i l√† 1 th∆∞ vi·ªán hay framework 


#2. What is NPM - Node Package Manager

 + npm l√† c√¥ng c·ª• gi√∫p ch√∫ng ta qu·∫£n l√Ω c√°c th∆∞ vi·ªán ƒë∆∞·ª£c x√¢y d·ª±ng s·∫µn cho node.js, bao g·ªìm mi·ªÖn ph√≠ v√† tr·∫£ ph√≠ 

 + n√≥ ch√≠nh l√† n∆°i l∆∞u tr·ªØ c√°c th∆∞ vi·ªán m√† l·∫≠p tr√¨nh vi√™n ch·ªâ c·∫ßn k√©o v·ªÅ v√† d√πng 


#3. Hello world v·ªõi Node.js (Basic)

  1. Hello world v·ªõi browser

	- t·∫°o file HTML
	- ƒë√≠nh k√®m file JS v√†o HTML

  2. Hello world v·ªõi nodejs

	- ƒê·ªÉ ch·∫°y file js, s·ª≠ d·ª•ng c√¢u l·ªánh:

	node path_to_file.js 

  3. l√Ω do g·ªçi nodejs l√† backend

	V·ªõi c√°ch l√†m th·ª© 2, ch√∫ng ta ƒëang ch·∫°y file ·ªü server v√† tr·∫£ ra k·∫øt qu·∫£, kh√¥ng ph·ª• thu·ªôc v√†o browser nh∆∞ c√°ch 1 

	>> Ch√∫ng ta g·ªçi nodejs l√† backend 


#4. C√°c th√†nh ph·∫ßn c·ªßa URL

 + URL(Uniform Resource Locator): hi·ªÉu ƒë∆°n gi·∫£n l√† ƒë∆∞·ªùng link truy c·∫≠p t·ªõi 1 website
 VD: https://www.google.com

 + C·∫•u tr√∫c c·ªßa URL: scheme://host:port/path?query

	Trong ƒë√≥: 

		+ scheme: ƒë·ªãnh nghƒ©a protocol ƒë·ªÉ truy c·∫≠p ngu·ªìn t√†i nguy√™n tr√™n internet, bao g·ªìm HTTP, v√† HTTPS 

		+ SSL (Secure Sockets Layer): gi√∫p code an to√†n h∆°n 

		+ host: n·ªõi ch·ª©a, l∆∞u tr·ªØ server: c√≥ th·ªÉ g·ªçi l√† domain name 

			

	> host name c√≥ th·ªÉ ch·ª©a port number

	+ T·∫°i 1 server c√≥ th·ªÉ s·ª≠ d·ª•ng nhi·ªÅu process t·∫°i 1 th·ªùi ƒëi·ªÉm, ƒë·ªÉ ƒë·ªãnh danh t·ª´ng process, PORT ƒë∆∞·ª£c s·ª≠ d·ª•ng 

	+ PORT number 16bit

	+ Khi client truy c·∫≠p v√†o 1 hostname, sv s·∫Ω t·ª± ƒë·ªông s·ª≠ d·ª•ng port ƒë·ªÉ kh·ªüi t·∫°o 

	VD:

		FTP: 21
		HTTP: 80
		HTTPS: 443

	=> Khi truy c·∫≠p v√†o https://abc.com th·ª±c ch·∫•t l√† ƒëang truy c·∫≠p v√†o https://abc.com:443

	=> V·ªõi dev, d√πng port c√≥ th·ªÉ ƒë·ªÉ ch·∫°y nhi·ªÅu project 1 l√∫c t·∫°i local

	
		
		+ path: ngu·ªìn t√†i nguy√™n ·ªü host m√† client mu·ªën truy c·∫≠p 

		VD: fb.com/watch 


		+ a query string: n·∫øu ƒë∆∞·ª£c s·ª≠ d·ª•ng, n√≥ s·∫Ω cung c·∫•p c√°c th√¥ng tin m√† client truy·ªÅn l√™n server 

		VD: fb.com/user?  > id=123 <



#5. Hello world v·ªõi Node.js (Advance)
	
	>> Tham kh·∫£o: https://nodejs.org/en

VD: ƒë√¢y ch·ªâ l√† c√°ch l√†m ch·∫°y, sau n√†y s·∫Ω d√πng c√°ch kh√°c 

import { createServer } from "node:http";

const hostname = "127.0.0.1";
const port = 4000; // 0 => ~ 65000

// T·∫°o 1 HTTP server v√† listen tr√™n port 3000 for request
const server = createServer((req, res) => {
  res.statusCode = 200;
  res.setHeader("Content-Type", "text/plain");
  res.end("Hello World!");
});

// Website s·∫Ω ch·∫°y ·ªü ƒë√¢u, sau khi server ch·∫°y, h√†m callback s·∫Ω ƒë∆∞·ª£c ch·∫°y

server.listen(port, hostname, () => {
  console.log(`server running at: https://${hostname}:${port}/`);
});

// T·ª± ƒë·ªông ch·∫°y tr√™n localhost
server.listen(port, () => {
  console.log(`server running at: https://${hostname}:${port}/`);
});

// run with `node server.mjs (module)`


	> Fix l·ªói tr√πng port 

	+ npx-kill-port PORT

	+ Kh·ªüi ƒë·ªông l·∫°i m√°y t√≠nh 

	+ ch·∫°y project t·∫°i port kh√°c 



#6. C√†i ƒë·∫∑t th∆∞ vi·ªán Node.JS v·ªõi NPM 

	+ V·ªõi c√°c th∆∞ vi·ªán c√≥ s·∫µn c·ªßa Node.js ch√∫ng ta c√≥ th·ªÉ ch·∫°y ƒë∆∞·ª£c web server, 
	+ Tuy nhi√™n v·ªõi vi·ªác s·ª≠ d·ª•ng npm. ch√∫ng ta c√≥ th·ªÉ c√†i ƒë·∫∑t c√°c th∆∞ vi·ªán c·∫ßn thi·∫øt ƒë·ªÉ x√¢y d·ª±ng web server

	1. npm init

	+ T·∫°o ra file package.json v√† c√°c th√¥ng tin c·∫ßn thi·∫øt

	2. C√†i ƒë·∫∑t th∆∞ vi·ªán

		> Ch·ªâ c√≥ th·ªÉ d√πng khi ƒë√£ c√≥ package.json 

	3. C√†i ƒë·∫∑t express

	npm i express

	

#7. C√†i ƒë·∫∑t th∆∞ vi·ªán ExpressJS (Hello world with ExpressJS)

	1. ExpressJS l√† g√¨ 

	+ Express.js l√† m·ªôt framework web nh·∫π v√† linh ho·∫°t d√†nh cho Node.js, gi√∫p b·∫°n d·ªÖ d√†ng x√¢y d·ª±ng c√°c ·ª©ng d·ª•ng web server v√† API. 


	üîß T√≥m t·∫Øt:

	Ng√¥n ng·ªØ: JavaScript (ch·∫°y tr√™n Node.js)

	M·ª•c ƒë√≠ch: X√¢y d·ª±ng web server ho·∫∑c RESTful API

	ƒê·∫∑c ƒëi·ªÉm n·ªïi b·∫≠t: Nh·∫π, ƒë∆°n gi·∫£n, d·ªÖ m·ªü r·ªông, ph·ªï bi·∫øn
	

	VD:

const express = require('express'); // index.js 
import express from "express"       // index.mjs 

const app = express();

// ƒê·ªãnh nghƒ©a route
app.get('/', (req, res) => {
  res.send('Xin ch√†o t·ª´ Express!');
});

// L·∫Øng nghe c·ªïng 3000
app.listen(3000, () => {
  console.log('Server ch·∫°y t·∫°i http://localhost:3000');
});


	üß∞ Express d√πng ƒë·ªÉ l√†m g√¨?

T·∫°o RESTful API

X√¢y d·ª±ng web server

X·ª≠ l√Ω c√°c route, middleware

Giao ti·∫øp v·ªõi c∆° s·ªü d·ªØ li·ªáu (k·∫øt h·ª£p v·ªõi th∆∞ vi·ªán kh√°c)

L√† n·ªÅn t·∫£ng c·ªßa c√°c framework l·ªõn h∆°n nh∆∞ NestJS	


(req, res) c√≥ r·∫•t nhi·ªÅu c√°c thu·ªôc t√≠nh . kh√°c. chi ti·∫øt tham kh·∫£o:

https://expressjs.com/en/5x/api.html#res
https://expressjs.com/en/5x/api.html#req


#8. M√¥ h√¨nh ho·∫°t ƒë·ªông c·ªßa ExpressJS

	1. C√°ch express ho·∫°t ƒë·ªông

const express = require("express");

const app = express();  // t·∫°o app express
const port = 3000; // port


// Khai b√°o routes
app.get("/", (req, res) => { // 2 obj trong m√¥i tr∆∞·ªùng node.js
  res.send("Hello World!");
});

// run l√™n server tr√™n port ƒë√£ kh·ªüi t·∫°o tr∆∞·ªõc ƒë·∫•y
app.listen(port, () => {
  console.log(`Example app listening on port ${port}`);
});


	2. tr·∫£i nghi·ªám c·ªßa ng∆∞·ªùi d√πng (client)

- Qu√° tr√¨nh website v·∫≠n h√†nh

	+ Tr∆∞·ªõc khi client v√†o web, server ƒë√£ ƒë∆∞·ª£c ch·∫°y l√™n, ss ƒë·ªÉ ho·∫°t ƒë·ªông.

- Khi server ƒë∆∞·ª£c ch·∫°y l√™n th√¨: 

	+ S·∫Ω ch·∫°y tr√™n 1 port, v√≠ d·ª• l√† :3000

- server bi·∫øt n√≥ c√≥ th·ªÉ x·ª≠ l√Ω c√°c route n√†o b·∫±ng c√°c n·∫°p th√¥ng tin ƒë·∫ßu v√†o qua 

	app.get("/", ()...

	=> ƒê√¢y ch√≠nh l√† ƒëo·∫°n code n√≥i cho server bi·∫øt, khi ng∆∞·ªùi d√πng v√†o route "/" th√¨ n√≥ c·∫©n g·ª≠i g√¨ 

- Khi client v√†o web v√† ·∫•n enter, t·∫°o 1 request l√™n server, mu·ªën sv hi·ªÉn th·ªã n·ªôi dung t∆∞∆°ng ·ª©ng v·ªõi route ƒë√≥

- Server nh·∫≠n ƒë∆∞·ª£c request, t√¨m trong ƒë·ªëng routes v√† tr·∫£ v·ªÅ k·∫øt qu·∫£ v·ªõi route t∆∞∆°ng ·ª©ng 


	=>  sau n√†y, ·ª©ng v·ªõi 1 t√≠nh nƒÉng (screen - m√†n h√¨nh) c·ªßa 1 web, s·∫Ω xu·∫•t ƒëi·ªÉm v·ªõi route ƒë·ªÉ bi·∫øt server l√†m g√¨.


#9. More routes with ExpressJS

	1. Khai b√°o th√™m routes

	+ ƒê·ªÉ khai b√°o th√™m routes ƒë∆°n gi·∫£n ch·ªâ l√† th√™m code v√†o 

app.get("/", (req, res) => {
  // 2 obj trong m√¥i tr∆∞·ªùng node.js
  res.send("Hello World!");
});

app.get("/abc", (req, res) => {
  // 2 obj trong m√¥i tr∆∞·ªùng node.js
  res.send("Hello !");
});


	2. C·∫•u tr√∫c: 

	app.METHOD(PATH, HANDLER)

		> app: ·ªü ƒë√¢y l√† ·ª©ng d·ª•ng express
		> method: l√† http request method
		> path: ƒë∆∞·ªùng link, route tr√™n server 
		> handler: function ƒë·ªÉ x·ª≠ l√Ω route ƒë∆∞·ª£c match 

	
	3. Tr·∫£ ra dynamic content 

	res.send("<h1>sfasd</h1>")

	∆Øu ƒëi·ªÉm: n·ªôi dung ƒë·ªông 
	Nh∆∞·ª£c ƒëi·ªÉm: Kh√¥ng b·∫£o tr√¨ ƒë∆∞·ª£c code.


	=> ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ ta c·∫ßn view engine (template engine)



	4. nh·ªõ c√≥ return sau c√¢u cu·ªëi c·ªßa res.render hay res.json,... ƒë·ªÉ ngƒÉn code k th·ª±c thi ti·∫øp xu·ªëng d∆∞·ªõi 

#10. Template Engine 

	(Link config: https://expressjs.com/en/guide/using-template-engines.html#using-template-engines-with-express)

	1. Template engine 

	+ Template engine (b·ªô m√°y d·ª±ng m·∫´u) l√† m·ªôt c√¥ng c·ª• gi√∫p b·∫°n k·∫øt h·ª£p d·ªØ li·ªáu t·ª´ backend v·ªõi m·ªôt file HTML template ƒë·ªÉ t·∫°o ra n·ªôi dung HTML cu·ªëi c√πng ƒë∆∞·ª£c g·ª≠i cho tr√¨nh duy·ªát ng∆∞·ªùi d√πng.

	+ Trong Express.js, b·∫°n c√≥ th·ªÉ d√πng c√°c template engine nh∆∞:

	EJS (Embedded JavaScript)

	Pug (tr∆∞·ªõc ƒë√¢y l√† Jade)
	...

‚ùì T·∫°i sao ph·∫£i d√πng template engine?

Khi x√¢y d·ª±ng ·ª©ng d·ª•ng backend (nh∆∞ Express.js), b·∫°n kh√¥ng mu·ªën vi·∫øt c√°c ƒëo·∫°n HTML d√†i d√≤ng b·∫±ng res.send() m·ªói l·∫ßn tr·∫£ v·ªÅ m·ªôt trang web.

Thay v√†o ƒë√≥:

B·∫°n vi·∫øt m·ªôt file HTML "m·∫´u" c√≥ ch·ªó ƒë·ªÉ ch√®n d·ªØ li·ªáu ƒë·ªông.

Template engine s·∫Ω ch√®n d·ªØ li·ªáu ƒë·ªông v√†o c√°c ph·∫ßn t·ª≠ ƒë√≥ r·ªìi render ra HTML ho√†n ch·ªânh.


	2. EJS

 + EJS l√† vi·∫øt t·∫Øt c·ªßa Embedded JavaScript.

 + L√† m·ªôt template engine ph·ªï bi·∫øn cho Express.js.

 + C√∫ ph√°p c·ªßa EJS r·∫•t gi·ªëng HTML thu·∫ßn, v√† b·∫°n c√≥ th·ªÉ nh√∫ng JavaScript v√†o HTML m·ªôt c√°ch d·ªÖ d√†ng.

	VD: <h1>Xin ch√†o <%= name %></h1>
	
	    res.render('greeting', { name: 'Long' });

	=> <h1>Xin ch√†o Long</h1>


‚úÖ T·∫°i sao d√πng EJS?

D·ªÖ h·ªçc, c√∫ ph√°p g·∫ßn gi·ªëng HTML.

T√≠ch h·ª£p t·ªët v·ªõi Express.

Cho ph√©p nh√∫ng logic ƒë∆°n gi·∫£n nh∆∞ if, for, include v√†o template.

Ph√π h·ª£p cho c√°c d·ª± √°n nh·ªè ho·∫∑c v·ª´a c·∫ßn server-side rendering.


	3. SSR v√† CSR

+ Khi s·ª≠ d·ª•ng template engine, t·ª©c l√† ta ƒëang render trang web theo ki·ªÉu SSR

	>>> SSR <<<

+ K·∫øt h·ª£p d·ªØ li·ªáu v·ªõi HTML ·ªü server, r·ªìi g·ª≠i nguy√™n file HTML cho client

	
	‚úÖ ∆Øu ƒëi·ªÉm:

ƒê∆°n gi·∫£n cho nh·ªØng trang web nh·ªè, √≠t t∆∞∆°ng t√°c (v√≠ d·ª•: blog, admin page‚Ä¶).

SEO t·ªët h∆°n v√¨ HTML ƒë∆∞·ª£c t·∫°o s·∫µn t·ª´ server.

Kh√¥ng c·∫ßn nhi·ªÅu JS ph√≠a client.

	
	>>> CSR <<<

+ Vi·∫øt HTML ·ªü client, g·ªçi API l·∫•y d·ªØ li·ªáu t·ª´ backend r·ªìi hi·ªÉn th·ªã ra

	‚úÖ ∆Øu ƒëi·ªÉm:

Tr·∫£i nghi·ªám t∆∞∆°ng t√°c nhanh (SPA).

Backend ƒë∆°n gi·∫£n, ch·ªâ tr·∫£ JSON.

Ph√¢n chia r√µ r√†ng gi·ªØa frontend (hi·ªÉn th·ªã) v√† backend (API).

	
	4. üìå C√°ch ch·ªçn ƒë√∫ng h∆∞·ªõng ƒëi:

M·ª•c ti√™u c·ªßa b·∫°n				S·ª≠ d·ª•ng
Web app hi·ªán ƒë·∫°i (SPA, dashboard, interactive)	‚úÖ API backend (Express, NestJS...) + CSR (React)
Web ƒë∆°n gi·∫£n, c·∫ßn HTML ƒë·ªông t·ª´ server		‚úÖ Template engine (EJS, Pug)
K·∫øt h·ª£p c·∫£ SSR + CSR + SEO			‚úÖ Next.js (ho·∫∑c Nuxt n·∫øu d√πng Vue)
	


Chapter 3: Project Structure

#1. ENV (Environment Variable)

	1. T·∫°i sao c·∫ßn env 

	- Tham s·ªë m√¥i tr∆∞·ªùng, l√† c√°c tham s·ªë thi·∫øt l·∫≠p chung. Thay v√¨ hardcode, ch√∫ng ta s·∫Ω c·∫•u h√¨nh t·∫≠p trung l·∫°i

	VD:

# app hostname and port
PORT=3000
HOST_NAME=localhost


	2. File .env

	- L√† file d√πng ƒë·ªãnh nghƒ©a c√°c tham s·ªë m√¥i tr∆∞·ªùng

	- C√°ch tham s·ªë ƒë∆∞·ª£c khai b√°o theo ƒë·ªãnh d·∫°ng: KEY=VALUE
	
	* L∆∞u √Ω: 
	+ Gi√° tr·ªã l∆∞u trong file s·∫Ω b·ªã convert sang string 
	+ ƒë·ªÉ th√™m comment, s·ª≠ d·ª•ng d·∫•u #
	+ kh√¥ng n√™n ƒë·∫©y file .env n√™n repo ƒë·ªÉ tr√°nh b·ªã l·ªô th√¥ng tin. n·∫øu mu·ªën h√£y t·∫°o th√™m file .env.example v√† paste c√°c bi·∫øn v√†o nh∆∞ng h√£y nh·ªõ x√≥a value ƒëi 
	
	
	3. S·ª≠ d·ª•ng v·ªõi nodejs

	(Link: https://www.npmjs.com/package/dotenv)
	
	+ Trong m√¥i tr∆∞·ªùng nodejs, khi ta mu·ªën l·∫•y gi√° tr·ªã t·ª´ .env th√¨ ph·∫£i d√πng "process.env.KEY", tuy nhi√™n ta c·∫ßn c√†i th√™m package nh∆∞ tr√™n th√¨ m·ªõi ƒë√πng ƒë∆∞·ª£c 

	+ M·ªói l·∫ßn update .env th√¨ c·∫ßn ch·∫°y l·∫°i app


#2. DevTool - Nodemon
	
	+ nodemon l√† 1 c√¥ng c·ª• gi√∫p ·ª©ng d·ª•ng node t·ª± ƒë·ªông restart l·∫°i m·ªói khi c√≥ file thay ƒë·ªïi 
	+ M·∫∑c ƒë·ªãnh: nodemon quan s√°t c√°c file sau: js, mjs, coffee, litcoffee


	1. S·ª≠ d·ª•ng v·ªõi nodejs 

	(Link: https://www.npmjs.com/package/nodemon)

	·ªü package.json thay node => nodemon

	
	* M·ªü r·ªông: s·ª± kh√°c bi·ªát gi·ªØa dependencies v√† devDependencies

	+ dep: c√°c package c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y production 

	+ devDep: c√°c package ch·ªâ c·∫ßn d√πng khi dev ·ª©ng d·ª•ng v√† k c·∫ßn tr√™n production 



#3. Static files 

	(Link config: https://expressjs.com/en/starter/static-files.html)

	+ To serve static files such as images, CSS files, and JavaScript files, use the express.static built-in middleware function in Express.
		

	VD:


// config static file
const path = require("path");
app.use(express.static(path.join(__dirname, "public")));



#4. M√¥ h√¨nh MVC v·ªõi NodeJS

	M√¥ h√¨nh MVC - MVC design pattern 

	+ Design pattern l√† c√°ch gi·∫£i ph√°p thi·∫øt k·∫ø ƒë·ªÉ x·ª≠ l√Ω b√†i to√°n 1 c√°ch hi·ªáu qu·∫£ nh·∫•t 

	+ V·ªõi m√¥ h√¨nh x√¢y d·ª±ng website, m√¥ h√¨nh MVC l√† c∆° b·∫£n nh·∫•t, c≈©ng ƒë∆∞·ª£c s·ª≠ d·ª•ng r·ªông r√£i.
	
	( MVC: Model - View - Controller )

	+ MVC gi√∫p vi·∫øt code theo t·ªï ch·ª©c, d·ªÖ d√†ng maintain v√† scale 

	

 1. View

	+ View l√† k·∫øt qu·∫£ nh√¨n th·∫•y c·ªßa client
	
	+ V·ªõi m√¥ h√¨nh client-server, client g·ª≠i request l√™n server, server g·ª≠i response l·∫°i cho client, view ch√≠nh l√† k·∫øt qu·∫£ m√† client nh·∫≠n ƒë∆∞·ª£c 


	
 2. Controller
	
	+ L√† n∆°i ƒëi·ªÅu h∆∞·ªõng d·ªØ li·ªáu

 	+ L√† c·∫ßu n·ªëi gi·ªØa Model v√† View.

	+ Nh·∫≠n y√™u c·∫ßu t·ª´ ng∆∞·ªùi d√πng (qua URL, form,...), x·ª≠ l√Ω logic v√† g·ªçi Model/View ph√π h·ª£p.

	+ Controller ƒë√≥ng vai tr√≤ nh∆∞ 1 leader gi√∫p ƒëi·ªÅu ph·ªëi th√¥n tin x·ª≠ l√Ω model v√† tr·∫£ v·ªÅ view cho ph√π h·ª£p 

V√≠ d·ª•: Khi ng∆∞·ªùi d√πng nh·∫•n n√∫t "Th√™m s·∫£n ph·∫©m", Controller nh·∫≠n s·ª± ki·ªán, g·ªçi Model ƒë·ªÉ l∆∞u v√†o DB v√† chuy·ªÉn h∆∞·ªõng v·ªÅ View.
	


3. Model (M - M√¥ h√¨nh d·ªØ li·ªáu)

	+ Ch·ªãu tr√°ch nhi·ªám x·ª≠ l√Ω d·ªØ li·ªáu v√† logic nghi·ªáp v·ª•.

	+ Giao ti·∫øp v·ªõi c∆° s·ªü d·ªØ li·ªáu (database).

	+ Kh√¥ng li√™n quan ƒë·∫øn giao di·ªán ng∆∞·ªùi d√πng.

V√≠ d·ª•: Trong ·ª©ng d·ª•ng b√°n h√†ng, Product l√† m·ªôt model l∆∞u th√¥ng tin nh∆∞ t√™n, gi√°, s·ªë l∆∞·ª£ng,‚Ä¶



üß† V√≠ d·ª• t·ªïng quan:

Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt trang web hi·ªÉn th·ªã danh s√°ch sinh vi√™n:

Model: K·∫øt n·ªëi c∆° s·ªü d·ªØ li·ªáu v√† l·∫•y danh s√°ch sinh vi√™n.

View: Giao di·ªán HTML/CSS hi·ªÉn th·ªã danh s√°ch sinh vi√™n.

Controller: Khi ng∆∞·ªùi d√πng truy c·∫≠p /sinhvien, controller g·ªçi Model ƒë·ªÉ l·∫•y d·ªØ li·ªáu v√† tr·∫£ v·ªÅ View.


‚úÖ ∆Øu ƒëi·ªÉm c·ªßa m√¥ h√¨nh MVC:

T√°ch bi·ªát r√µ r√†ng gi·ªØa ph·∫ßn d·ªØ li·ªáu, giao di·ªán v√† logic.

D·ªÖ m·ªü r·ªông, b·∫£o tr√¨.

C√≥ th·ªÉ l√†m vi·ªác nh√≥m hi·ªáu qu·∫£: m·ªôt ng∆∞·ªùi l√†m Model, ng∆∞·ªùi kh√°c l√†m View, v.v.
	



#5. T·ªï ch·ª©c c√°c th∆∞ m·ª•c project theo m√¥ h√¨nh MVC

	+ Th√¥ng th∆∞·ªùng 1 project s·∫Ω c√≥ c√°c th∆∞ m·ª•c nh∆∞ sau 

	/src >
		
		/ configs

		/ controllers
		/ middlewares
		/ migrations
		/ models
		/ public
		/ routes
		/ seeder
		/ services
		/ views
		  server.js
	

#6. √Åp d·ª•ng m√¥ h√¨nh MVC v√† gi·∫£i th√≠ch c√°c th∆∞ m·ª•c tr√™n 

	> Chi ti·∫øt n·ªôi dung c√°c file c√≥ trong project "backend-from-zero-nodejs"

	1. /configs

	+ ch·ª©a c√°c config nh∆∞ template view, static files,..

	
	2. /routes  > web.js, api.js

	+ ch·ª©a c√°c routes ph·ª•c v·ª• cho vi·ªác ssr v√† restful api 

		1. web.js 

		>> tham kh·∫£o: https://expressjs.com/en/guide/routing.html		

		+ chia t√°ch routes

// routes.js

import express from "express";

const router = express.Router();

// Khai b√°o routes
router.get("/", (req, res) => {
  // 2 obj trong m√¥i tr∆∞·ªùng node.js
  res.send("Hello World!");
});

router.get("/abc", (req, res) => {
  res.render("sample.ejs");
});

export default router;

// server.js

app.use("/", webRoutes); // => tham s·ªë "/" s·∫Ω cho bi·∫øt to√†n b·ªô c√°c routes s·∫Ω ƒë·ª©ng sau n√≥. VD: /test/abc
	

	
	3. /controllers

	  + handle vi·ªác ph·∫£i l√†m khi c√≥ routes th√≠ch h·ª£p 


VD: 
router.get("/", getHomePage);
	
=> getHomePage ch√≠nh l√† logic x·ª≠ l√Ω khi c√≥ routes ƒë√≥, ta s·∫Ω vi·∫øt b√™n trong controller 

VD: 

const getHomePage = (req, res) => {
  // process data
  // call model
  res.send("Hello World!");
};

const getABC = (req, res) => {
  res.render("sample.ejs");
};

export { getHomePage, getABC };

	
	4. /models

	+ controller ch·ªâ l√† t·ªïng quan v√† render,... C√≤n logic b√™n trong controller s·∫Ω ƒë∆∞·ª£c vi·∫øt v√†o model 



Chapter 4: Setup Docker & Database SQL


#1. Docker l√† g√¨ ?

	+ Docker l√† m·ªôt n·ªÅn t·∫£ng gi√∫p ƒë√≥ng g√≥i (package), ph√¢n ph·ªëi (ship) v√† ch·∫°y (run) c√°c ·ª©ng d·ª•ng trong c√°c container ‚Äî m·ªôt m√¥i tr∆∞·ªùng nh·∫π, ƒë·ªôc l·∫≠p v√† nh·∫•t qu√°n v·ªõi h·ªá ƒëi·ªÅu h√†nh.


Docker l√† m·ªôt c√¥ng c·ª• m√£ ngu·ªìn m·ªü cho ph√©p:

	+ T·∫°o ra c√°c container: gi·ªëng nh∆∞ m·ªôt m√°y ·∫£o nh·∫π.

	+ ƒê√≥ng g√≥i ·ª©ng d·ª•ng k√®m to√†n b·ªô m√¥i tr∆∞·ªùng ch·∫°y, nh∆∞: h·ªá ƒëi·ªÅu h√†nh, th∆∞ vi·ªán, file c·∫•u h√¨nh‚Ä¶

	+ Tri·ªÉn khai nh·∫•t qu√°n ·ª©ng d·ª•ng ·ªü b·∫•t k·ª≥ ƒë√¢u (local, server, cloud...).


üîß T√°c d·ª•ng c·ªßa Docker ƒë·ªëi v·ªõi d·ª± √°n Backend

	1. ƒê√≥ng g√≥i backend th√†nh container
Docker gi√∫p ƒë√≥ng g√≥i code backend (Node.js, Python, Java...) v√†o m·ªôt container.

B·∫°n kh√¥ng c·∫ßn quan t√¢m "m√°y ch·ªß c√≥ c√†i ƒë√∫ng phi√™n b·∫£n Node, Python... kh√¥ng" ‚Äî v√¨ Docker ƒë√£ k√®m s·∫µn trong container.


	2. Tri·ªÉn khai d·ªÖ d√†ng, nh·∫•t qu√°n
D√π b·∫°n ch·∫°y app tr√™n m√°y local, staging hay production, container ƒë·ªÅu gi·ªëng nhau.

Tr√°nh l·ªói ki·ªÉu ‚Äúch·∫°y ƒë∆∞·ª£c ·ªü m√°y em, nh∆∞ng kh√¥ng ch·∫°y tr√™n server‚Äù.


	3. D·ªÖ qu·∫£n l√Ω c√°c d·ªãch v·ª• ph·ª• tr·ª£
Backend th∆∞·ªùng c·∫ßn DB nh∆∞ PostgreSQL, Redis... Docker gi√∫p b·∫°n kh·ªüi ƒë·ªông ch√∫ng d·ªÖ d√†ng b·∫±ng docker-compose.

L∆∞u tr·ªØ database

	
	4. TƒÉng t·ªëc ƒë·ªô ph√°t tri·ªÉn
M·ªói l·∫≠p tr√¨nh vi√™n clone code v·ªÅ ch·ªâ c·∫ßn docker-compose up l√† c√≥ ƒë·∫ßy ƒë·ªß backend, database ƒë·ªÉ dev.

Kh√¥ng c·∫ßn c√†i ƒë·∫∑t m√¥i tr∆∞·ªùng r∆∞·ªùm r√†.

	5. D·ªÖ CI/CD
Docker image c√≥ th·ªÉ ƒë·∫©y l√™n Docker Hub v√† deploy tr·ª±c ti·∫øp l√™n server b·∫±ng c√°c c√¥ng c·ª• CI/CD (GitHub Actions, GitLab CI...).



#2. Setup d·ª± √°n MySQL v·ªõi Docker v√† DBeaver

	+ Relational Database

	> Relational Database : C∆° s·ªü d·ªØ li·ªáu quan h·ªá (SQL), c√≥ th·ªÉ k·ªÉ t·ªõi: MySQL, SQL 	Server, Postgres, Oracle...


1. DBeaver
Download: https://dbeaver.io/download/
DBeaver (b·∫£n Community Free) gi√∫p k·∫øt n·ªëi t·ªõi c√°c h·ªá c∆° s·ªü d·ªØ li·ªáu, all-in-one


2. K·∫øt n·ªëi database

B1: T·∫°o database MySQL v·ªõi docker
‚Üí ƒê·∫£m b·∫£o r·∫±ng m√°y t√≠nh ƒë√£ ch·∫°y docker (v·ªõi Windows, MacOS th√¨ ch·∫°y s·∫µn Docker Desktop)

B2: T·∫°o database v·ªõi Docker Compose
‚Üí ƒê·∫£m b·∫£o r·∫±ng, v√¨ d·ªØ c≈© ·ªü m√°y t√≠nh, c√≤n d·ªØ t√†i nguy√™n (dung l∆∞·ª£ng) ƒë·ªÉ l∆∞u tr·ªØ.

Download file c√†i ƒë·∫∑t:
[Google Drive link]
(https://drive.google.com/file/d/1DfSjTZMBRYXbKCde5qRo_HYJ3YJWNtGa/view?usp=share_link)


B3: Ch·∫°y c√¢u l·ªánh cmd b√™n trong th∆∞ m·ª•c ch·ª©a file mysql.yml

	> docker compose -f mysql.yml -p nodejs-sql up -d

-f: file name

-p: project name

-d: detach, run as background


B4: t·∫°o connection trong DBeaver

Port: 3307 > t√πy file mysql
Username/password: root/123456 > t√πy 

	L∆∞u √Ω: 

DBeaver kh√¥ng ph·∫£i l√† database, n√≥ l√† ph·∫ßn m·ªÅm gi√∫p truy c·∫≠p v√† s·ª≠ d·ª•ng database.
Database ƒë∆∞·ª£c t·∫°o b√™n trong Docker :v

Sau n√†y, m·ªói l·∫ßn c·∫ßn s·ª≠ d·ª•ng database MySQL, ƒë·∫£m b·∫£o r·∫±ng ƒë√£ ch·∫°y docker tr∆∞·ªõc. V√¨ kh√¥ng c√≥ docker, th√¨ c≈©ng kh√¥ng c√≥ database

Kh√¥ng c·∫ßn "update docker" ƒë·ªÉ h·∫°n ch·∫ø m·∫•t d·ªØ li·ªáu



#3. S·ª≠ d·ª•ng MySQL v·ªõi Node.js

	1. C√†i ƒë·∫∑t mysql2

	https://www.npmjs.com/package/mysql2


	2. t·∫°o data cho database: 
	
	+ v√†o dbeaver v√† t·∫°o d·ªØ li·ªáu cho b·∫£ng 

VD:

CREATE TABLE Users (
id int not null auto_increment primary key,
email varchar(255),
name varchar(255),
city varchar(255)
);

insert into Users 
values (1, "doanthien@gmail.com", "DoanThien", "HaiPhong");

insert into Users 
values (2, "mymy@gmail.com", "Domy", "HaiPhong");


select * from Users u;



	3. k·∫øt n·ªëi t·ªõi database 
	
	- L∆∞u √Ω: c·∫ßn chay docker ƒë·ªÉ c√≥ database 

	( https://sidorares.github.io/node-mysql2/docs )

VD:

// Get the client
import mysql from 'mysql2/promise';

// Create the connection to database
const connection = await mysql.createConnection({
  host: 'localhost',
  user: 'root',
  database: 'test',
});

// A simple SELECT query
try {
  const [results, fields] = await connection.query(
    'SELECT * FROM `table` WHERE `name` = "Page" AND `age` > 45'
  );

  console.log(results); // results contains rows returned by server
  console.log(fields); // fields contains extra meta data about results, if available
} catch (err) {
  console.log(err);
}




#4. T√°i s·ª≠ d·ª•ng Connection 

	1. chia t√°ch file connections

	+ Ta n√™n chia file config connections sang b√™n file m·ªõi trong config/db.mjs 

	+ kh√¥ng n√™n hardcode c√°c th√¥ng s·ªë, l∆∞u v√†o env ƒë·ªÉ sau n√†y thay cho ti·ªán 

VD:
	db.mjs 


import { config } from "dotenv";
config();

import mysql from "mysql2/promise";

const connection = await mysql.createConnection({
  host: process.env.DB_HOST,
  port: process.env.DB_PORT,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,
  database: process.env.DB_NAME,
});

export default connection;



#5. Connection Cost, t·∫°o m·ªõi connection 


	M·ªôt s·ªë v·∫•n ƒë·ªÅ g·∫∑p ph·∫£i v·ªõi c√°ch l√†m hi·ªán t·∫°i 


1. T·∫°o m·ªõi connection m·ªói l·∫ßn truy v·∫•n g√¢y t·ªën k√©m

	+ M·ªói l·∫ßn truy v·∫•n s·∫Ω t·∫°o 1 connection m·ªõi ‚Üí t·ªën th·ªùi gian v√† t√†i nguy√™n.

	+ ƒê·∫∑c bi·ªát n·∫øu backend ·ªü Vi·ªát Nam v√† database ·ªü USA ‚Üí ƒë·ªô tr·ªÖ tƒÉng cao.


2. Kh√¥ng ƒë√≥ng connection sau khi d√πng

	+ N·∫øu kh√¥ng ƒë√≥ng ‚Üí d·∫´n ƒë·∫øn t·ªìn ƒë·ªçng connection ‚Üí r√≤ r·ªâ t√†i nguy√™n.

	+ V√≠ d·ª•: 1000 user truy c·∫≠p c√πng l√∫c ‚Üí 1000 connection kh√¥ng ƒë∆∞·ª£c ƒë√≥ng ‚Üí nguy hi·ªÉm.

	+ C·∫ßn ƒë√≥ng connection sau khi d√πng b·∫±ng c√°c h√†m nh∆∞ close, destroy.


3. Database c√≥ gi·ªõi h·∫°n t√†i nguy√™n (rate limit)

	+ Database l√† ph·∫ßn m·ªÅm, n√™n t·ªën t√†i nguy√™n (CPU/RAM).

	+ Nhi·ªÅu connection ‚Üí t·∫£i n·∫∑ng h∆°n, c√≥ th·ªÉ khi·∫øn DB b·ªã treo ho·∫∑c t·ª± restart.

	+ Ph·∫£i t·ªëi ∆∞u c√°ch t·∫°o v√† qu·∫£n l√Ω connection ƒë·ªÉ kh√¥ng v∆∞·ª£t gi·ªõi h·∫°n ch·ªãu t·∫£i.
	
	
	
#6. Connection Pool Pattern, t·ªëi ∆∞u connection fix c√°c v·∫•n ƒë·ªÅ tr√™n 

	(Tham kh·∫£o: https://sidorares.github.io/node-mysql2/docs )

	+ ƒê·ªÉ gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ tr√™n ta c√≥ 1 kh√°i ni·ªám: Connection Pools

	+ Connection pools help reduce the time spent connecting to the MySQL server by reusing a previous connection, leaving them open instead of closing when you are done with them.


	VD:

Thay v√¨ s·ª≠ d·ª•ng await mysql.createConnection() th√¨: 

import mysql from 'mysql2/promise';

// Create the connection pool. The pool-specific settings are the defaults
const pool = mysql.createPool({
  host: 'localhost',
  user: 'root',
  database: 'test',
  waitForConnections: true,
  connectionLimit: 10,
  maxIdle: 10, // max idle connections, the default value is the same as `connectionLimit`
  idleTimeout: 60000, // idle connections timeout, in milliseconds, the default value 60000
  queueLimit: 0,
  enableKeepAlive: true,
  keepAliveInitialDelay: 0,
});



Chapter 5: CRUD v·ªõi Nodejs 


#1. Express v√† req.body

	(Tham kh·∫£o: https://stackoverflow.com/questions/9304888/how-to-get-data-passed-from-a-form-in-express-node-js )

	+ ƒë·ªÉ l·∫•y ƒë∆∞·ª£c data g·ª≠i t·ª´ client l√™n server ta c·∫ßn th∆∞ vi·ªán ƒë·ªÉ h·ªó tr·ª£ l√†m ƒëi·ªÅu ƒë√≥.
	
	>>

app.use(express.json()); // Used to parse JSON bodies
app.use(express.urlencoded()); //Parse URL-encoded bodies


	* L∆∞u √Ω khi s·ª≠ d·ª•ng form HTML

	+ ƒê·ªÉ server c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c data g·ª≠i t·ª´ client l√™n server th√¥ng qua req.body, ch√∫ng ta ph·∫£i d√πng thu·ªôc t√≠nh attrbute l√† name, kh√¥ng ph·∫£i id cho ph·∫ßn t·ª≠ HTML mu·ªën l·∫•y gi√° tr·ªã 




#2. Truy·ªÅn data ƒë·ªông t·ª´ client l√™n server 

	VD v·ªõi ch·ª©c nƒÉng create user: 

// Create user
const postCreateUser = async (req, res) => {
  let { name, email, city } = req.body;
  // Using placeholders
  try {
    await connection.query(
      `insert into Users 
      (email, name, city) values (?, ?, ?)`,
      [email, name, city]
    );
    res.send("Create user success!");
  } catch (err) {
    console.log(err);
  }
};


- Khi ta s·ª≠ d·ª•ng th∆∞ vi·ªán mysql2 ƒë·ªÉ th·ª±c hi·ªán insert new user v√†o database th√¨ ta c·∫ßn ph·∫£i truy·ªÅn theo ki·ªÉu ƒë·ªông.


`insert into Users 
      (email, name, city) values (?, ?, ?)`,
      [email, name, city]


>> ta kh√¥ng truy·ªÅn tr·ª±c ti·∫øp gi√° tr·ªã v√†o c√¢u l·ªánh m√† th√¥ng qua ? v√† m·∫£ng ·ªü d∆∞·ªõi. m·∫£ng ·ªü d∆∞·ªõi s·∫Ω l·∫ßn l∆∞·ª£t thay th·∫ø v√†o c√°c ? tr√™n c√¢u l·ªánh v√† g·ª≠i ƒëi. 


#3. Truy·ªÅn data t·ª´ sv to ejs file 

	C√∫ ph√°p: app.render(view, [locals], callback)

	views: render ra view
	local: truy·ªÅn data nh·∫≠n ƒë∆∞·ª£c trong func to ejs file 

VD: 

const getHomePage = async (req, res) => {
  try {
    let results = await getAllUser();
    res.render("home.ejs", { listUser: results });
  } catch (error) {
    console.log(error)
  }
};



#4. S·ª≠ d·ª•ng ejs ƒë·ªÉ in data ra HTML 

	(Tham kh·∫£o: https://ejs.co/ )

VD v·ªÅ 1 v√≤ng l·∫∑p s·ª≠ d·ª•ng EJS

  <% listUser.forEach(function(user) { %>
                            <tr>
                                <th scope="row">
                                    <%= user.id %>
                                </th>
                                <td>
                                    <%= user.name %>
                                </td>
                                <td>
                                    <%= user.email %>
                                </td>
                                <td>
                                    <%= user.city %>
                                </td>
                                <td>
                                    <button>
                                        <a style="text-decoration: none; color: black;" rel="stylesheet"
                                            href="/edit-user">Edit</a>
                                    </button>
                                    <button>Delete</button>
                                </td>
                            </tr>
                            <% }); %>


	Gi·∫£i th√≠ch: 

<% ... %> l√† c√∫ ph√°p EJS ƒë·ªÉ ch·∫°y JavaScript nh∆∞ng kh√¥ng in ra HTML.

<%= ... %> l√† c√∫ ph√°p EJS ƒë·ªÉ in ra k·∫øt qu·∫£ c·ªßa bi·ªÉu th·ª©c JavaScript v√†o HTML.



#5. Route params

	(Tham kh·∫£o th√™m: https://expressjs.com/en/guide/routing.html#routing )

ƒê·ªÉ l·∫•y ƒë∆∞·ª£c param t·ª´ URL ta c·∫ßn s·ª≠ d·ª•ng req.params

VD:

const getUpdatePage = (req, res) => {
  const userID = req.params.id;

  res.render("edit-user.ejs");
};



Chapter 6: RESTful API 


	1. REST l√† g√¨ ? 

+ REST (Representational State Transfer) l√† m·ªôt phong c√°ch ki·∫øn tr√∫c do Roy Fielding ƒë·ªÅ xu·∫•t trong lu·∫≠n √°n ti·∫øn sƒ© nƒÉm 2000. RESTful API l√† m·ªôt ·ª©ng d·ª•ng c·ªßa REST trong vi·ªác thi·∫øt k·∫ø API.

+ RESTful API l√† m·ªôt ki·ªÉu ki·∫øn tr√∫c ph·∫ßn m·ªÅm d√πng ƒë·ªÉ x√¢y d·ª±ng c√°c d·ªãch v·ª• web. RESTful API s·ª≠ d·ª•ng HTTP ƒë·ªÉ giao ti·∫øp gi·ªØa client (frontend, mobile app,...) v√† server (backend), th∆∞·ªùng trao ƒë·ªïi d·ªØ li·ªáu qua JSON.


	2. C·∫•u tr√∫c RESTful API 


HTTP	 Method	H√†nh ƒë·ªông (CRUD)	M√¥ t·∫£

GET	Read	L·∫•y d·ªØ li·ªáu t√†i nguy√™n

POST	Create	T·∫°o t√†i nguy√™n m·ªõi

PUT	Update	C·∫≠p nh·∫≠t to√†n b·ªô t√†i nguy√™n

PATCH	Update	C·∫≠p nh·∫≠t m·ªôt ph·∫ßn t√†i nguy√™n

DELETE	Delete	Xo√° t√†i nguy√™n


	VD: 
	 Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt API qu·∫£n l√Ω ng∆∞·ªùi d√πng:

H√†nh ƒë·ªông		URL	HTTP Method

L·∫•y danh s√°ch user	/users	GET

L·∫•y 1 user		/users/:id	GET

T·∫°o user m·ªõi		/users	POST

C·∫≠p nh·∫≠t user (to√†n b·ªô)	/users/:id	PUT

C·∫≠p nh·∫≠t user (1 ph·∫ßn)	/users/:id	PATCH

Xo√° user	/users/:id	DELETE



	4. Quy t·∫Øc thi·∫øt k·∫ø RESTful API


	 > S·ª≠ d·ª•ng danh t·ª´, kh√¥ng d√πng ƒë·ªông t·ª´ cho URL

‚úÖ /users thay v√¨ ‚ùå /getUsers ho·∫∑c /createUser


	> S·ª≠ d·ª•ng ƒë√∫ng HTTP method

GET ƒë·ªÉ ƒë·ªçc, POST ƒë·ªÉ t·∫°o, PUT/PATCH ƒë·ªÉ s·ª≠a, DELETE ƒë·ªÉ xo√°.

	
	> Kh√¥ng ch·ª©a tr·∫°ng th√°i trong URL

Tr√°nh /users/active=true ‚Üí n√™n d√πng /users?status=active


	> Tr·∫£ v·ªÅ m√£ HTTP ch√≠nh x√°c

	(https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status)	

200 OK, 201 Created, 204 No Content, 400 Bad Request, 404 Not Found, 500 Internal Server Error


VD: 

const getAllUser = async (req, res) => {
  try {
    const [results] = await connection.execute("SELECT * FROM Users ");
    return res.status(200).json(results);
  } catch (err) {
    console.log(err);
  }
};



	> S·ª≠ d·ª•ng JSON ƒë·ªÉ trao ƒë·ªïi d·ªØ li·ªáu

Response ho·∫∑c Request body n√™n ·ªü d·∫°ng JSON:
{
  "name": "Alice",
  "email": "alice@example.com"
}


	> D√πng m√£ ho√° v√† ph√¢n trang n·∫øu c·∫ßn thi·∫øt

V√≠ d·ª•: /users?page=2&limit=10


	5. ∆Øu ƒëi·ªÉm c·ªßa RESTful API

ƒê∆°n gi·∫£n, d·ªÖ hi·ªÉu, d·ªÖ b·∫£o tr√¨.

Kh√¥ng tr·∫°ng th√°i (stateless): m·ªói request ƒë·ªôc l·∫≠p.

Linh ho·∫°t, c√≥ th·ªÉ d√πng v·ªõi b·∫•t k·ª≥ client n√†o (React, Angular, mobile, v.v.)

D·ªÖ m·ªü r·ªông.


	6. API vi·∫øt ·ªü ƒë√¢u

	+ API b·∫Øt bu·ªôc vi·∫øt ·ªü ph√≠a server b·∫±ng c√°c ng√¥n ng·ªØ c·ª• th·ªÉ 

	
	

Chapter 7: Upload file 

	1. Upload single file


	(https://stackabuse.com/handling-file-uploads-in-node-js-with-expres-and-multer/)

	- t·ªïng quan lu·ªìng upload file l√™n b√™n th·ª© 3

	B1: Client ch·ªçn file 

	B2: t·∫°o formData ƒë·ªÉ chu·∫©n b·ªã g·ª≠i file 

	B3: g·ª≠i file v·ªÅ backend ƒë·ªÉ x·ª≠ l√Ω ho·∫∑c g·ª≠i tr·ª±c ti·∫øp l√™n b√™n th·ª© 3 l∆∞u tr·ªØ 

	B4: D·ªãch v·ª• b√™n th·ª© 3 tr·∫£ v·ªÅ URL c≈©ng nh∆∞ th√¥ng tin file 

	B5: l∆∞u URL v√†o database ƒë·ªÉ ti·ªán s·ª≠ d·ª•ng 


	+ S·ª≠ d·ª•ng multer ƒë·ªÉ upload file l∆∞u v√†o local 

	B1. C√†i ƒë·∫∑t multer + app-root-path

	B2. t·∫°o giao di·ªán upload file 


 <form method="post" action="/upload-avt" enctype="multipart/form-data">
                <label for="avt-file">Avatar: </label>
                <input type="file" name="avt-file" id="avt-file">
                <div>
                    <input type="submit" value="Save">
                </div>
            </form>


	B3: t·∫°o routes v√† c·∫•u h√¨nh 

const storage = multer.diskStorage({
  destination: function (req, file, cb) {
    cb(null, appRoot + "/src/public/images/");
  },

  // By default, multer removes file extensions so let's add them back
  filename: function (req, file, cb) {
    cb(
      null,
      file.fieldname + "-" + Date.now() + path.extname(file.originalname)
    );
  },
});

const imageFilter = function (req, file, cb) {
  // Accept images only
  if (!file.originalname.match(/\.(jpg|JPG|jpeg|JPEG|png|PNG|gif|GIF)$/)) {
    req.fileValidationError = "Only image files are allowed!";
    return cb(new Error("Only image files are allowed!"), false);
  }
  cb(null, true);
};

let upload = multer({ storage: storage, fileFilter: imageFilter });

router.post("/upload-avt", upload.single("avt-file"), handleUploadFile);



	>> ƒë∆∞a ra n∆°i l·ªØu tr·ªØ v√† validate file 


	B4: h√†m handle upload file 

const handleUploadFile = async (req, res) => {
  try {
    if (req.fileValidationError) {
      return res.send(req.fileValidationError);
    } else if (!req.file) {
      return res.send("Please select an image to upload");
    }

    // Show uploaded image
    res.send(
      `You have uploaded this image: <hr/><img src="/images/${req.file.filename}" width="500"><hr /><a href="/upload">Upload another image</a>`
    );
  } catch (err) {
    console.error(err);
    res.status(500).send("Something went wrong during upload");
  }
};



	2. Upload multiple file

	t∆∞∆°ng t·ª±, ch·ªâ thay m·ªói 

	+ router.post("/upload-multi-avt", upload.array("avt-files", 3), uploadMultipleFiles);

	

Chapter 8: Middleware chu·∫©n form v·ªõi Nodejs v√† expressjs

	( https://expressjs.com/en/guide/using-middleware.html )

	( https://www.npmjs.com/package/morgan ) : middleware logger


	s·ª≠ d·ª•ng: app.use() l√† ƒëang s·ª≠ d·ª•ng middleware
	
	KN:

Trong Express.js, middleware l√† c√°c h√†m trung gian ƒë∆∞·ª£c th·ª±c thi trong qu√° tr√¨nh x·ª≠ l√Ω request-response. Ch√∫ng c√≥ th·ªÉ can thi·ªáp, x·ª≠ l√Ω ho·∫∑c k·∫øt th√∫c request tr∆∞·ªõc khi ƒë·∫øn route handler cu·ªëi c√πng, ho·∫∑c chuy·ªÉn ti·∫øp sang middleware ti·∫øp theo.


	VD:

router.post("/abc", (req, res, next) => {...}, handleSmt)

(req, res, next) => { ... }          // Middleware b√¨nh th∆∞·ªùng
(err, req, res, next) => { ... }     // Middleware x·ª≠ l√Ω l·ªói



	1. Application-level middleware

	+ ƒë∆∞·ª£c s·ª≠ d·ª•ng b·∫±ng c√°ch app.use()
	
	VD:


const hostname = process.env.HOST_NAME;

// config req.body
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// Routes
app.use("/", webRouter);
app.use("/api", apiRouter);

// config viewEngine
configViewEngine(app);

// 404 middleware
app.use((req, res) => {
  return res.render("404.ejs");
});



	> 404 middleware n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c thi sau khi app qu√©t qua h·∫øt c√°c route m√† k t√¨m ƒë∆∞·ª£c route t∆∞∆°ng ·ª©ng 


	2. Route-level middleware 


VD:

router.use('/user/:id', (req, res, next) => {
  console.log('Request URL:', req.originalUrl)
  next()
}, (req, res) => {
  console.log('Request Type:', req.method)
})
	

	> next(): trong middleware c√≥ t√°c d·ª•ng cho bi·∫øt r·∫±ng code ƒë·∫±ng sau n√≥ s·∫Ω ti·∫øp t·ª•c ƒë∆∞·ª£c th·ª±c thi 

	
		

	
	

	

